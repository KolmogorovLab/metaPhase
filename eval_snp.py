from build_data import *
import gfapy


bam="/Users/ekaterina.kazantseva/MT/5strain_hifi_sim/flye_3ecoli_sim_noalt_haplo/SNP_test/testSNP.bam"
gfa = "/Users/ekaterina.kazantseva/MT/5strain_hifi_sim/flye_3ecoli_sim_noalt_haplo/assembly_graph_trans_43.gfa"
AF=0.1
snp=None
edges=["edge_1", "edge_10", "edge_100_10080", "edge_100_10081", "edge_100_1010001", "edge_100_103", "edge_101_1010001", "edge_101_67", "edge_101_81", "edge_102_1010001", "edge_102_1010002", "edge_102_1010003", "edge_102_24", "edge_102_263", "edge_103", "edge_103_10085", "edge_103_10086", "edge_103_1010002", "edge_103_124", "edge_103_88", "edge_104_1010001", "edge_104_1010002", "edge_104_1010003", "edge_104_1010004", "edge_104_1010005", "edge_104_397", "edge_104_451", "edge_105", "edge_105_1010001", "edge_105_1010002", "edge_105_1010003", "edge_105_1010004", "edge_105_1098", "edge_105_1397", "edge_105_1422", "edge_105_16", "edge_105_273", "edge_105_536", "edge_106", "edge_106_1010001", "edge_106_65", "edge_107_46", "edge_108_1010001", "edge_108_79", "edge_109", "edge_109_180", "edge_11", "edge_110_139", "edge_110_170", "edge_110_61", "edge_111_14", "edge_111_67", "edge_112_86", "edge_112_87", "edge_113", "edge_114", "edge_114_121", "edge_114_80", "edge_115", "edge_115_18", "edge_116", "edge_117", "edge_118", "edge_119", "edge_11_122", "edge_11_65", "edge_12", "edge_120_1010001", "edge_120_1010002", "edge_120_109", "edge_121", "edge_121_112", "edge_121_154", "edge_122", "edge_122_69", "edge_123", "edge_124", "edge_125", "edge_126", "edge_126_1010001", "edge_126_1010002", "edge_126_67", "edge_126_73", "edge_127", "edge_128_107", "edge_128_233", "edge_129", "edge_13", "edge_130", "edge_130_46", "edge_130_8", "edge_131", "edge_132", "edge_132_10137", "edge_132_10138", "edge_132_132", "edge_133", "edge_133_1010001", "edge_133_65", "edge_134", "edge_135", "edge_135_179", "edge_135_190", "edge_136", "edge_137_176", "edge_137_72", "edge_138", "edge_139", "edge_139_1010001", "edge_139_90", "edge_13_288", "edge_13_56", "edge_14", "edge_140_14", "edge_140_15", "edge_141", "edge_142", "edge_142_1010001", "edge_142_1010002", "edge_142_1010003", "edge_142_1010004", "edge_142_1010006", "edge_142_1010008", "edge_142_1010009", "edge_142_1010010", "edge_142_1160", "edge_142_129", "edge_142_1427", "edge_142_181", "edge_142_717", "edge_142_78", "edge_143", "edge_144", "edge_144_10185", "edge_145", "edge_145_14", "edge_145_241", "edge_145_63", "edge_146_1010001", "edge_146_12", "edge_147_1010001", "edge_147_141", "edge_148", "edge_148_14", "edge_149_1010001", "edge_149_15", "edge_149_59", "edge_150_184", "edge_150_5", "edge_150_95", "edge_151_1010001", "edge_151_1010002", "edge_151_154", "edge_151_171", "edge_152", "edge_152_107", "edge_152_116", "edge_153", "edge_154", "edge_154_14", "edge_154_9", "edge_155", "edge_156", "edge_157", "edge_158", "edge_158_160", "edge_159", "edge_15_1010001", "edge_15_98", "edge_16", "edge_160_115", "edge_160_48", "edge_161", "edge_162", "edge_163_49", "edge_163_9", "edge_164", "edge_165_1010001", "edge_165_1010002", "edge_165_1010003", "edge_165_20", "edge_165_216", "edge_165_276", "edge_166", "edge_167", "edge_167_71", "edge_168", "edge_169_1010001", "edge_169_12", "edge_169_3", "edge_16_8", "edge_17", "edge_170_68", "edge_170_72", "edge_170_79", "edge_171", "edge_171_140", "edge_172", "edge_173", "edge_174", "edge_174_1010001", "edge_174_1010003", "edge_174_105", "edge_174_144", "edge_174_308", "edge_175_1010001", "edge_175_142", "edge_175_161", "edge_175_183", "edge_176", "edge_177_1010001", "edge_177_14", "edge_177_50", "edge_177_58", "edge_178", "edge_179_146", "edge_179_196", "edge_179_271", "edge_17_109", "edge_17_56", "edge_180", "edge_181", "edge_182_110", "edge_182_86", "edge_183", "edge_184", "edge_185", "edge_186", "edge_187", "edge_188", "edge_188_8", "edge_189_56", "edge_18_1000000", "edge_190", "edge_190_196", "edge_191", "edge_192_11", "edge_192_118", "edge_192_126", "edge_192_7", "edge_193", "edge_193_10145", "edge_193_10146", "edge_193_48", "edge_194", "edge_195", "edge_195_17", "edge_196", "edge_197", "edge_197_100", "edge_197_112", "edge_198_10", "edge_198_101", "edge_198_1010001", "edge_198_1010002", "edge_199", "edge_19_1010001", "edge_19_19", "edge_19_6", "edge_2", "edge_20", "edge_200", "edge_200_1010001", "edge_200_109", "edge_201_1010001", "edge_201_1010002", "edge_201_1010003", "edge_201_1010004", "edge_201_1010005", "edge_201_1010006", "edge_201_1010007", "edge_201_223", "edge_201_418", "edge_201_6", "edge_201_885", "edge_202", "edge_203", "edge_203_14", "edge_203_93", "edge_204_100", "edge_204_1010001", "edge_204_1010002", "edge_204_168", "edge_204_224", "edge_205", "edge_206", "edge_206_19", "edge_206_52", "edge_207_55", "edge_208", "edge_209_1010001", "edge_209_1010002", "edge_209_10271", "edge_209_10272", "edge_209_11", "edge_209_192", "edge_21", "edge_210_1010001", "edge_210_1010002", "edge_210_42", "edge_211_102", "edge_211_24", "edge_212", "edge_213", "edge_214", "edge_214_105", "edge_214_127", "edge_215", "edge_215_129", "edge_216", "edge_217_1010001", "edge_217_22", "edge_218_1010002", "edge_218_262", "edge_218_416", "edge_218_43", "edge_218_96", "edge_219", "edge_219_277", "edge_219_301", "edge_22", "edge_220", "edge_221", "edge_221_10176", "edge_221_10177", "edge_221_247", "edge_222", "edge_223", "edge_224", "edge_225", "edge_226_41", "edge_227", "edge_228", "edge_229", "edge_22_10", "edge_22_10132", "edge_22_10133", "edge_23", "edge_230_1010001", "edge_230_1010002", "edge_230_118", "edge_230_145", "edge_230_92", "edge_231_41", "edge_232", "edge_233_57", "edge_233_85", "edge_234", "edge_235", "edge_236", "edge_237", "edge_238_60", "edge_239", "edge_239_137", "edge_239_4", "edge_240_1010001", "edge_240_1010002", "edge_240_1010003", "edge_240_1010004", "edge_240_130", "edge_241_1010001", "edge_241_1010002", "edge_241_1010003", "edge_241_1010004", "edge_241_1010005", "edge_241_1010006", "edge_241_1010007", "edge_241_50", "edge_242_1010001", "edge_242_1010002", "edge_242_1010003", "edge_242_1010004", "edge_242_1010005", "edge_242_110", "edge_243", "edge_244_3", "edge_245", "edge_245_1010001", "edge_245_10112", "edge_245_10113", "edge_245_10114", "edge_245_30", "edge_246", "edge_247", "edge_247_138", "edge_247_50", "edge_248_42", "edge_248_47", "edge_249_1010001", "edge_249_1010002", "edge_249_202", "edge_249_212", "edge_24_14", "edge_24_32", "edge_250", "edge_251_209", "edge_251_258", "edge_252", "edge_253_248", "edge_253_288", "edge_254_10062", "edge_254_10063", "edge_254_1010001", "edge_254_1010002", "edge_254_290", "edge_255_101", "edge_255_124", "edge_256", "edge_257", "edge_258", "edge_259", "edge_259_46", "edge_259_97", "edge_25_29", "edge_25_34", "edge_25_79", "edge_260", "edge_261_35", "edge_261_62", "edge_262_1010001", "edge_262_1010002", "edge_262_1010003", "edge_262_1010004", "edge_262_1010005", "edge_262_1010006", "edge_262_1010007", "edge_262_1010008", "edge_262_138", "edge_262_787", "edge_262_870", "edge_263_1010001", "edge_263_1010002", "edge_263_1010003", "edge_263_1010004", "edge_263_1010005", "edge_263_1010006", "edge_263_1010007", "edge_263_7", "edge_264_1010001", "edge_264_1010002", "edge_264_1010003", "edge_264_1010004", "edge_264_1010005", "edge_264_1010006", "edge_264_1010007", "edge_264_388", "edge_265_1010001", "edge_265_62", "edge_266", "edge_266_25", "edge_266_5", "edge_267", "edge_268", "edge_268_1010001", "edge_268_15", "edge_269_198", "edge_269_216", "edge_26_1010001", "edge_26_1010002", "edge_26_16", "edge_27", "edge_270", "edge_270_1010001", "edge_270_40", "edge_271_1010001", "edge_271_1010002", "edge_271_112", "edge_271_308", "edge_272", "edge_273", "edge_274_1010001", "edge_274_1010002", "edge_274_1010003", "edge_274_312", "edge_275", "edge_275_40", "edge_275_45", "edge_276", "edge_276_1010001", "edge_276_10144", "edge_276_10146", "edge_276_564", "edge_277", "edge_277_172", "edge_277_217", "edge_278_1010001", "edge_278_10480", "edge_278_226", "edge_278_490", "edge_278_595", "edge_278_671", "edge_279_1010001", "edge_279_10175", "edge_279_10176", "edge_279_10177", "edge_279_10258", "edge_279_10259", "edge_279_10808", "edge_279_10809", "edge_279_698", "edge_279_90", "edge_27_41", "edge_27_54", "edge_28", "edge_280_177", "edge_280_265", "edge_281_10095", "edge_281_10096", "edge_281_1010001", "edge_281_1010002", "edge_281_10466", "edge_281_10467", "edge_281_64", "edge_282", "edge_282_10290", "edge_282_10291", "edge_282_214", "edge_283", "edge_283_10112", "edge_283_302", "edge_284", "edge_284_10279", "edge_284_10280", "edge_284_90", "edge_285", "edge_285_10148", "edge_285_10213", "edge_285_73", "edge_286", "edge_286_174", "edge_286_257", "edge_287", "edge_287_6", "edge_288", "edge_288_121", "edge_288_188", "edge_289", "edge_289_1010001", "edge_289_10287", "edge_289_10288", "edge_289_10289", "edge_289_392", "edge_290_1010001", "edge_290_1010003", "edge_290_10405", "edge_290_10406", "edge_290_10407", "edge_290_10408", "edge_290_154", "edge_290_608", "edge_290_641", "edge_291_112", "edge_291_168", "edge_292_10", "edge_292_1010001", "edge_292_184", "edge_293", "edge_293_1010001", "edge_293_1010003", "edge_293_10502", "edge_293_176", "edge_294_225", "edge_294_227", "edge_294_322", "edge_295_10019", "edge_295_10020", "edge_295_1010001", "edge_295_1010002", "edge_295_390", "edge_296", "edge_296_287", "edge_296_308", "edge_297", "edge_297_203", "edge_297_211", "edge_297_76", "edge_298", "edge_298_17", "edge_298_75", "edge_299", "edge_299_10087", "edge_299_10088", "edge_299_1010001", "edge_29_1010001", "edge_29_1010002", "edge_29_1010003", "edge_29_257", "edge_29_75", "edge_3", "edge_30", "edge_300_135", "edge_300_206", "edge_300_234", "edge_301", "edge_301_125", "edge_301_67", "edge_302", "edge_302_1010001", "edge_302_1010002", "edge_302_155", "edge_302_384", "edge_302_57", "edge_302_603", "edge_303", "edge_304_10025", "edge_304_10026", "edge_304_1010001", "edge_304_315", "edge_304_499", "edge_304_7", "edge_305", "edge_305_1010004", "edge_305_1010005", "edge_305_10121", "edge_305_10122", "edge_305_10203", "edge_305_448", "edge_306", "edge_306_1010001", "edge_306_784", "edge_306_896", "edge_307_1010001", "edge_307_10158", "edge_307_10159", "edge_307_10160", "edge_307_10161", "edge_307_343", "edge_307_461", "edge_307_474", "edge_307_49", "edge_308", "edge_308_1354", "edge_309_1010001", "edge_309_10253", "edge_309_148", "edge_309_177", "edge_30_1010001", "edge_30_33", "edge_31", "edge_310", "edge_310_1010001", "edge_310_16", "edge_310_363", "edge_310_410", "edge_310_460", "edge_311", "edge_311_60", "edge_312_1010001", "edge_312_258", "edge_312_318", "edge_312_4", "edge_312_65", "edge_312_83", "edge_313", "edge_313_77", "edge_313_80", "edge_314_10069", "edge_314_1010001", "edge_314_405", "edge_314_434", "edge_315_1010001", "edge_315_1010002", "edge_315_10929", "edge_315_296", "edge_315_394", "edge_315_578", "edge_315_820", "edge_316_1010001", "edge_316_152", "edge_316_90", "edge_317_63", "edge_317_92", "edge_318", "edge_318_23", "edge_318_48", "edge_319_123", "edge_319_136", "edge_319_2", "edge_31_1010001", "edge_31_173", "edge_32", "edge_320", "edge_321_169", "edge_321_197", "edge_321_250", "edge_321_491", "edge_321_505", "edge_322_1010002", "edge_322_1010003", "edge_322_151", "edge_322_379", "edge_322_412", "edge_322_93", "edge_323", "edge_323_1010002", "edge_323_11275", "edge_323_11595", "edge_323_1192", "edge_323_81", "edge_323_837", "edge_323_984", "edge_324_196", "edge_324_64", "edge_325", "edge_325_10090", "edge_325_10091", "edge_325_1010002", "edge_325_1010003", "edge_325_10517", "edge_325_347", "edge_326", "edge_326_10346", "edge_326_10347", "edge_327_12", "edge_327_148", "edge_327_314", "edge_328", "edge_328_196", "edge_328_386", "edge_328_75", "edge_329_1010002", "edge_329_10248", "edge_329_10249", "edge_329_298", "edge_330", "edge_330_1010002", "edge_331", "edge_331_10291", "edge_331_16", "edge_331_228", "edge_332", "edge_332_1010001", "edge_332_1010002", "edge_332_17", "edge_333", "edge_333_17", "edge_333_80", "edge_334", "edge_334_10034", "edge_334_1010001", "edge_334_1010003", "edge_334_10424", "edge_334_1072", "edge_334_10968", "edge_334_988", "edge_335", "edge_335_114", "edge_335_137", "edge_336_1010001", "edge_336_234", "edge_336_302", "edge_336_799", "edge_336_826", "edge_337_1010001", "edge_337_1010002", "edge_337_10340", "edge_337_10341", "edge_337_10538", "edge_337_10539", "edge_337_390", "edge_338", "edge_338_1010001", "edge_338_112", "edge_338_186", "edge_339_128", "edge_339_171", "edge_339_88", "edge_33_13", "edge_33_29", "edge_340", "edge_340_1010001", "edge_340_1010002", "edge_340_10130", "edge_340_10131", "edge_340_16", "edge_340_457", "edge_341", "edge_341_21", "edge_342", "edge_342_1010001", "edge_342_1010002", "edge_342_10122", "edge_342_6", "edge_343", "edge_343_161", "edge_344_1010001", "edge_344_10458", "edge_344_10459", "edge_344_354", "edge_344_614", "edge_344_675", "edge_344_763", "edge_344_820", "edge_345_80", "edge_345_97", "edge_346_107", "edge_346_263", "edge_346_89", "edge_347", "edge_347_1010001", "edge_347_10185", "edge_347_10186", "edge_347_10188", "edge_347_10614", "edge_347_134", "edge_347_461", "edge_347_607", "edge_348", "edge_348_3", "edge_348_313", "edge_348_376", "edge_348_460", "edge_348_82", "edge_349_1010001", "edge_349_1010002", "edge_349_10149", "edge_349_10150", "edge_349_10151", "edge_349_265", "edge_349_47", "edge_34_9", "edge_35", "edge_350", "edge_350_1010001", "edge_350_10483", "edge_350_11102", "edge_350_203", "edge_350_72", "edge_351_120", "edge_351_27", "edge_351_612", "edge_352_11", "edge_352_93", "edge_353_435", "edge_353_706", "edge_353_994", "edge_354", "edge_354_10072", "edge_354_1010002", "edge_354_10245", "edge_354_10246", "edge_354_289", "edge_354_474", "edge_355", "edge_355_10042", "edge_355_10043", "edge_355_368", "edge_356_28", "edge_356_98", "edge_357_1010001", "edge_357_1010002", "edge_357_155", "edge_357_250", "edge_358", "edge_358_10104", "edge_358_200", "edge_358_262", "edge_359_10080", "edge_359_10081", "edge_359_1010001", "edge_359_1010002", "edge_359_1010003", "edge_359_1010004", "edge_359_10360", "edge_359_10361", "edge_359_11064", "edge_359_11065", "edge_359_642", "edge_359_72", "edge_359_729", "edge_35_8", "edge_36", "edge_360_10092", "edge_360_10093", "edge_360_1010002", "edge_360_1010003", "edge_360_1010004", "edge_360_10406", "edge_360_10407", "edge_360_10408", "edge_360_219", "edge_360_744", "edge_361", "edge_361_1136", "edge_361_132", "edge_361_164", "edge_361_204", "edge_361_256", "edge_362_234", "edge_362_247", "edge_362_321", "edge_362_357", "edge_362_43", "edge_363_120", "edge_363_4", "edge_364_128", "edge_364_230", "edge_365_112", "edge_365_64", "edge_366", "edge_366_24", "edge_367", "edge_368_104", "edge_368_171", "edge_369", "edge_369_56", "edge_36_83", "edge_36_93", "edge_37", "edge_370", "edge_371", "edge_372", "edge_373", "edge_373_1010002", "edge_373_10139", "edge_373_10141", "edge_373_387", "edge_373_434", "edge_374_152", "edge_374_98", "edge_375_1010002", "edge_375_10238", "edge_375_10240", "edge_375_10241", "edge_375_154", "edge_375_454", "edge_376", "edge_376_35", "edge_377_275", "edge_377_304", "edge_377_37", "edge_378_1010001", "edge_378_1010002", "edge_378_10359", "edge_378_10360", "edge_378_4", "edge_379_10070", "edge_379_301", "edge_379_448", "edge_38", "edge_380", "edge_380_1010001", "edge_380_110", "edge_381_28", "edge_381_86", "edge_382_54", "edge_382_63", "edge_383", "edge_383_114", "edge_383_249", "edge_384_1010001", "edge_384_1010002", "edge_384_10987", "edge_384_10988", "edge_384_226", "edge_384_992", "edge_385_10097", "edge_385_10098", "edge_385_1010002", "edge_385_256", "edge_385_436", "edge_385_565", "edge_386", "edge_386_1010002", "edge_386_1010003", "edge_386_443", "edge_387_228", "edge_387_71", "edge_387_94", "edge_388_34", "edge_388_77", "edge_38_111", "edge_38_59", "edge_39", "edge_39_94", "edge_3_10010", "edge_3_10011", "edge_3_10023", "edge_3_10031", "edge_3_1010001", "edge_3_1010003", "edge_40", "edge_41_1010001", "edge_41_1010002", "edge_41_1010003", "edge_41_129", "edge_41_385", "edge_41_400", "edge_41_450", "edge_41_74", "edge_42", "edge_42_23", "edge_43", "edge_44_1010001", "edge_44_1010002", "edge_44_1010003", "edge_44_1010004", "edge_44_364", "edge_44_408", "edge_45", "edge_45_1010001", "edge_46", "edge_47_126", "edge_47_34", "edge_48", "edge_49", "edge_4_1010001", "edge_4_33", "edge_4_38", "edge_4_6", "edge_50_139", "edge_50_266", "edge_51", "edge_51_11", "edge_52_122", "edge_52_30", "edge_53", "edge_54_15", "edge_55_1010001", "edge_55_1010002", "edge_55_34", "edge_56_1010001", "edge_56_1010002", "edge_56_36", "edge_56_90", "edge_57", "edge_58_107", "edge_58_113", "edge_58_14", "edge_59", "edge_5_1010002", "edge_5_1010003", "edge_5_158", "edge_5_271", "edge_5_95", "edge_6", "edge_60", "edge_60_15", "edge_60_78", "edge_61", "edge_61_10", "edge_61_13", "edge_62", "edge_62_22", "edge_62_77", "edge_63", "edge_64", "edge_65_10", "edge_65_54", "edge_66_16", "edge_66_72", "edge_67", "edge_68", "edge_68_10", "edge_69", "edge_70_1010001", "edge_70_1010002", "edge_70_1010003", "edge_70_166", "edge_71", "edge_71_144", "edge_71_28", "edge_72", "edge_72_1010001", "edge_72_141", "edge_73", "edge_74_106", "edge_74_25", "edge_75", "edge_75_10066", "edge_75_10067", "edge_75_71", "edge_76_1010001", "edge_76_1010002", "edge_76_183", "edge_76_187", "edge_77", "edge_78", "edge_79_250", "edge_79_66", "edge_7_129", "edge_7_169", "edge_7_77", "edge_8", "edge_80_1010001", "edge_80_253", "edge_80_58", "edge_80_63", "edge_81_1010001", "edge_81_1010002", "edge_81_2", "edge_81_28", "edge_82_64", "edge_83", "edge_84", "edge_84_113", "edge_84_36", "edge_85", "edge_86_17", "edge_86_84", "edge_87_1010001", "edge_87_1010002", "edge_87_92", "edge_88", "edge_89_1010001", "edge_89_71", "edge_9", "edge_90", "edge_90_56", "edge_90_94", "edge_91", "edge_91_30", "edge_92", "edge_93", "edge_93_1010001", "edge_93_10849", "edge_94", "edge_95_1010001", "edge_95_1010002", "edge_95_90", "edge_96_1010001", "edge_96_1010002", "edge_96_128", "edge_96_83", "edge_97_1010001", "edge_97_18", "edge_97_9", "edge_98_1010001", "edge_98_57", "edge_98_96", "edge_99"]


stats = open('output/eval_SNP.txt', 'a')
for edge in edges:
    SNP_pos=read_snp(snp,edge, bam, AF)
    ln = pysam.samtools.coverage("-r", edge, bam, "--no-header").split()[4]
    cov = pysam.samtools.coverage("-r", edge, bam, "--no-header").split()[6]
    stats.write(edge + "\t" +str(len(SNP_pos))+ "\t"+str(ln)+ "\t"+str(cov)+ "\n")



stats.close()

